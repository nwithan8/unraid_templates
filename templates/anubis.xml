<?xml version="1.0"?>
<Container version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="https://raw.githubusercontent.com/nwithan8/unraid_templates/main/template_schema.xsd template_schema.xsd">
    <Name>Anubis</Name>
    <Repository>ghcr.io/techarohq/anubis:latest</Repository>
    <Registry>ghcr.io/techarohq/anubis</Registry>
    <Branch>
        <Tag>latest</Tag>
        <TagDescription>Latest stable release</TagDescription>
    </Branch>
    <Branch>
        <Tag>main</Tag>
        <TagDescription>Latest edge release</TagDescription>
    </Branch>
    <Network>bridge</Network>
    <WebUI>http://[IP]:[PORT:8923]/</WebUI>
    <Privileged>false</Privileged>
    <Support>https://anubis.techaro.lol/docs/</Support>
    <Project>https://anubis.techaro.lol/</Project>
    <Overview>
        Anubis is a Web AI Firewall Utility that weighs the soul of your connection using one or more challenges in order to protect upstream resources from scraper bots. &#xD;
        [br]
        This program is designed to help protect the small internet from the endless storm of requests that flood in from AI companies. Anubis is as lightweight as possible to ensure that everyone can afford to protect the communities closest to them. &#xD;
        [br]
        See configuration instructions: https://anubis.techaro.lol/docs/admin/installation/#configuration
    </Overview>
    <Beta>False</Beta>
    <Category>AI: Network:Web Network:Management Network:Privacy Productivity: Tools: Other: Status:Stable</Category>
    <ExtraSearchTerms>ai scraping bot protection firewall reverse proxy challenge block cloudflare captcha</ExtraSearchTerms>
    <Icon>https://raw.githubusercontent.com/TecharoHQ/anubis/refs/heads/main/docs/static/img/anubis/happy.webp</Icon>
    <TemplateURL>https://raw.githubusercontent.com/nwithan8/unraid_templates/main/templates/anubis.xml</TemplateURL>
    <Maintainer>
        <WebPage>https://github.com/nwithan8</WebPage>
    </Maintainer>
    <Changes>
        ### 2025-07-22

        Initial release
    </Changes>
    <Requires>
        Expects a `botPolicy.yaml` file to be mounted at `/mnt/user/appdata/anubis/botPolicy.yaml` before starting the container. See configuration details: https://anubis.techaro.lol/docs/admin/installation/#configuration
    </Requires>
    <Config Name="Web UI Port" Target="8923" Default="8923" Mode="tcp" Description="Container Port: 8923" Type="Port" Display="always-hide" Required="true" Mask="false">8923</Config>
    <Config Name="Metrics Port" Target="9090" Default="9090" Mode="tcp" Description="Container Port: 9090" Type="Port" Display="always" Required="false" Mask="false">9090</Config>
    <Config Name="Target" Target="TARGET" Default="http://localhost:3923" Description="The URL of the service that Anubis should forward valid requests to. Supports Unix domain sockets, set this to a URI like so: unix:///path/to/socket.sock." Type="Variable" Display="always-hide" Required="true" Mask="false">http://localhost:3923</Config>
    <Config Name="Policy File" Target="/data/cfg/botPolicy.yaml" Default="/mnt/user/appdata/anubis/botPolicy.yaml" Description="Path to the bot policy file." Type="Path" Mode="ro" Display="always-hide" Required="true" Mask="false">/mnt/user/appdata/anubis/botPolicy.yaml</Config>
    <Config Name="Base Prefix" Target="BASE_PREFIX" Default="" Description="If set, adds a global prefix to all Anubis endpoints. For example, setting this to /myapp would make Anubis accessible at /myapp/ instead of /. This is useful when running Anubis behind a reverse proxy that routes based on path prefixes." Type="Variable" Display="always" Required="false" Mask="false"/>
    <Config Name="Bind Port" Target="BIND" Default=":8923" Description="Internal bind port to the host system" Type="Variable" Display="always-hide" Required="true" Mask="false">:8923</Config>
    <Config Name="Bind Network" Target="BIND_NETWORK" Default="tcp" Description="The address family that Anubis listens on" Type="Variable" Display="always-hide" Required="true" Mask="false">tcp</Config>
    <Config Name="Cookie - Domain" Target="COOKIE_DOMAIN" Default="" Description="The domain the Anubis challenge pass cookie should be set to. This should be set to the domain you bought from your registrar (EG: techaro.lol if your webapp is running on anubis.techaro.lol)" Type="Variable" Display="always" Required="false" Mask="false"/>
    <Config Name="Cookie - Dynamic Domain" Target="COOKIE_DYNAMIC_DOMAIN" Default="false|true" Description="If set to true, automatically set cookie domain fields based on the hostname of the request. EG: if you are making a request to anubis.techaro.lol, the Anubis cookie will be valid for any subdomain of techaro.lol." Type="Variable" Display="always-hide" Required="true" Mask="false"/>
    <Config Name="Cookie - Expiration Time" Target="COOKIE_EXPIRATION_TIME" Default="168h" Description="The amount of time the authorization cookie is valid for." Type="Variable" Display="always-hide" Required="true" Mask="false">168h</Config>
    <Config Name="Cookie - Partitioned" Target="COOKIE_PARTITIONED" Default="false|true" Description="If set to true, enables the partitioned (CHIPS) flag, meaning that Anubis inside an iframe has a different set of cookies than the domain hosting the iframe." Type="Variable" Display="always-hide" Required="true" Mask="false"/>
    <Config Name="Cookie - Secure" Target="COOKIE_SECURE" Default="true|false" Description="If set to true, enables the Secure flag, meaning that the cookies will only be transmitted over HTTPS. If Anubis is used in an unsecure context (plain HTTP), this will be need to be set to false." Type="Variable" Display="always-hide" Required="true" Mask="false"/>
    <Config Name="Difficulty" Target="DIFFICULTY" Default="4" Description="The difficulty of the challenge, or the number of leading zeroes that must be in successful responses." Type="Variable" Display="always-hide" Required="true" Mask="false">4</Config>
    <Config Name="ed25519 Private Key Hex" Target="ED25519_PRIVATE_KEY_HEX" Default="" Description="The hex-encoded ed25519 private key used to sign Anubis responses. If this is not set, Anubis will generate one for you. This should be exactly 64 characters long. When running multiple instances on the same base domain, the key must be the same across all instances." Type="Variable" Display="always" Required="false" Mask="true"/>
    <Config Name="ed25519 Private Key Hex File" Target="ED25519_PRIVATE_KEY_HEX_FILE" Default="" Description="Internal path to a file containing the hex-encoded ed25519 private key. Only one of this or its sister option may be set." Type="Variable" Display="always" Required="false" Mask="true"/>
    <Config Name="Metrics - Bind" Target="METRICS_BIND" Default=":9090" Description="Internal bind network address that Anubis serves Prometheus metrics on." Type="Variable" Display="always-hide" Required="true" Mask="false">:9090</Config>
    <Config Name="Metrics - Bind Network" Target="METRICS_BIND_NETWORK" Default="tcp" Description="The address family that the Anubis metrics server listens on." Type="Variable" Display="always-hide" Required="true" Mask="false">tcp</Config>
    <Config Name="Open Graph - Expiry Time" Target="OG_EXPIRY_TIME" Default="24h" Description="The expiration time for the Open Graph tag cache. Prefer using the policy file to configure the Open Graph subsystem." Type="Variable" Display="always" Required="true" Mask="false">24h</Config>
    <Config Name="Open Graph - Passthrough" Target="OG_PASSTHROUGH" Default="false|true" Description="If set to true, Anubis will enable Open Graph tag passthrough. Prefer using the policy file to configure the Open Graph subsystem." Type="Variable" Display="always" Required="true" Mask="false"/>
    <Config Name="Open Graph - Consider Host Cache" Target="OG_CACHE_CONSIDER_HOST" Default="false|true" Description="If set to true, Anubis will consider the host in the Open Graph tag cache key. Prefer using the policy file to configure the Open Graph subsystem." Type="Variable" Display="always" Required="true" Mask="false"/>
    <Config Name="Policy File Name" Target="POLICY_FNAME" Default="" Description="The internal file name containing bot policy configuration. See the bot policy documentation for more details. If unset, the default bot policy configuration is used." Type="Variable" Display="always" Required="false" Mask="false"/>
    <Config Name="Redirect Domains" Target="REDIRECT_DOMAINS" Default="" Description="If set, restrict the domains that Anubis can redirect to when passing a challenge. If unset, Anubis may redirect to any domain which could cause security issues in the unlikely case that an attacker passes a challenge for your browser and then tricks you into clicking a link to your domain. Note, if you are hosting Anubis on a non-standard port, you must also include the port number here." Type="Variable" Display="always" Required="false" Mask="false"/>
    <Config Name="Server Robots.txt" Target="SERVE_ROBOTS_TXT" Default="false|true" Description="If set true, Anubis will serve a default robots.txt file that disallows all known AI scrapers by name and then additionally disallows every scraper. This is useful if facts and circumstances make it difficult to change the underlying service to serve such a robots.txt file." Type="Variable" Display="always-hide" Required="true" Mask="false"/>
    <Config Name="Strip Base Prefix" Target="STRIP_BASE_PREFIX" Default="false|true" Description="If set to true, strips the base prefix from request paths when forwarding to the target server. This is useful when your target service expects to receive requests without the base prefix. For example, with BASE_PREFIX=/foo and STRIP_BASE_PREFIX=true, a request to /foo/bar would be forwarded to the target as /bar." Type="Variable" Display="always-hide" Required="true" Mask="false"/>
    <Config Name="Use Remote Address" Target="USE_REMOTE_ADDRESS" Default="" Description="If set to true, Anubis will take the client's IP from the network socket. For production deployments, it is expected that a reverse proxy is used in front of Anubis, which pass the IP using headers, instead." Type="Variable" Display="always-hide" Required="false" Mask="false"/>
    <Config Name="Webmaster Email" Target="WEBMASTER_EMAIL" Default="" Description="If set, shows a contact email address when rendering error pages. This email address will be how users can get in contact with administrators." Type="Variable" Display="always-hide" Required="false" Mask="false"/>
    <Config Name="Strip private X-Forwarded-For Headers" Target="XFF_STRIP_PRIVATE" Default="true|false" Description="If set, strip private addresses from X-Forwarded-For headers." Type="Variable" Display="always-hide" Required="true" Mask="false"/>
    <Config Name="Socket Mode" Target="SOCKET_MODE" Default="" Description="Only used when at least one of the *_BIND_NETWORK variables are set to unix. The socket mode (permissions) for Unix domain sockets." Type="Variable" Display="advanced" Required="false" Mask="false"/>
</Container>
